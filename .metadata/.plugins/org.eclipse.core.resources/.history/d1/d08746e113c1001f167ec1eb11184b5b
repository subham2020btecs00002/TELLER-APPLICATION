package com.example.bank.controller;

import com.example.bank.model.Account;
import com.example.bank.service.AccountService;
import lombok.RequiredArgsConstructor;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;
import java.util.Optional;

import java.util.List;

@RestController
@RequestMapping("/api/accounts")
@RequiredArgsConstructor
public class AccountController {
    private final AccountService accountService;

    @PostMapping
    public ResponseEntity<Account> createAccount(@RequestBody Account account) {
        Account createdAccount = accountService.createAccount(account);
        return ResponseEntity.ok(createdAccount);
    }

    @GetMapping("/customer/{customerId}")
    public ResponseEntity<List<Account>> getAccountsByCustomerId(@PathVariable Long customerId) {
        return ResponseEntity.ok(accountService.getAccountsByCustomerId(customerId));
    }

    @GetMapping("/{accountId}")
    public ResponseEntity<Account> getAccountById(@PathVariable Long accountId) {
        return ResponseEntity.ok(accountService.getAccountById(accountId));
    }
    @GetMapping("/number/{accountNumber}")
    public ResponseEntity<Object> getAccountInfoByAccountNumber(@PathVariable String accountNumber) {
        Optional<Account> accountOpt = accountService.getAccountByAccountNumber(accountNumber);
        if (accountOpt.isPresent()) {
            Account account = accountOpt.get();
            return ResponseEntity.ok(new AccountInfoResponse(
                account.getAccountId(),
                account.getCustomer().getCustomerId(),
                account.getOpeningBalance(),
                account.getClosingBalance()
            ));
        } else {
            return ResponseEntity.status(404).body("Account not found");
        }
    }

    // Inner class for the response structure
//    public static class AccountInfoResponse {
//        private Long accountId;
//        private Long customerId;
//        private double openingBalance;
//        private double closingBalance;
//
//        public AccountInfoResponse(Long accountId, Long customerId, double openingBalance, double closingBalance) {
//            this.accountId = accountId;
//            this.customerId = customerId;
//            this.openingBalance = openingBalance;
//            this.closingBalance = closingBalance;
//        }
//
//        public Long getAccountId() {
//            return accountId;
//        }
//
//        public Long getCustomerId() {
//            return customerId;
//        }
//
//        public double getOpeningBalance() {
//            return openingBalance;
//        }
//
//        public double getClosingBalance() {
//            return closingBalance;
//        }
//    }

}
